{% extends "layouts/app.html" %}
{% block title %}Solicitação #{{ solicitacao.id }}{% endblock %}

{% block content %}
<div class="card p-4 shadow-sm">

  <h5 class="fw-bold mb-3">
    Solicitação #{{ solicitacao.id }} — {{ solicitacao.data.strftime("%d/%m/%Y") }}
  </h5>

  <p><strong>Solicitante:</strong> {{ solicitacao.solicitante }}</p>
  <p><strong>Cliente:</strong> {{ solicitacao.cliente }}</p>
  <p><strong>Atividades:</strong> {{ solicitacao.atividades }}</p>

  <hr>

  <h6 class="fw-bold">Funcionários</h6>
  <ul>
    {% for f in funcionarios %}
      <li>{{ f.nome }} ({{ f.matricula }})</li>
    {% endfor %}
  </ul>

  <hr>

  <h6 class="fw-bold">Aprovações</h6>
  {% for role in ["gestor","gerente","controladoria","diretoria","rh"] %}
    <div class="mb-2">
      <strong>{{ role|capitalize }}:</strong>
      {% if aprovacoes.get(role) %}
        {{ aprovacoes[role].username }}
      {% else %}
        <button class="btn btn-sm btn-outline-success btn-aprovar"
                data-role="{{ role }}">
          Aprovar
        </button>
      {% endif %}
    </div>
  {% endfor %}

  <hr>

  <button class="btn btn-outline-warning"
          onclick="window.open('/api/solicitacoes/{{ solicitacao.id }}/provisao')">
    Provisão de Gastos
  </button>

</div>
{% endblock %}
